{% extends 'base.html' %} {% block content %}
<div class="container mt-4">
<h5 >Cadastrar Novo Produto</h5>

  <div class="card" id="form-bg" style="color: black">
    <div class="card-body">
      <form action="{{ url_for('cadastro') }}" method="POST">
        <div class="mb-3">
          <label for="name" class="form-label">Nome:</label>
          <input
            type="text"
            class="form-control"
            id="name"
            name="name"
            placeholder="Digite o nome do produto"
            required
          />
        </div>
        <div class="mb-3">
          <label for="year" class="form-label">Ano de Fabricação:</label>
          <input
            type="number"
            class="form-control"
            id="year"
            name="year"
            placeholder="Digite o ano de fabricação"
            required
          />
        </div>
        <div class="mb-3">
          <label for="categoria_id" class="form-label">Categoria:</label>
          <select class="form-control" id="categoria_id" name="categoria_id">
            <option value="">Selecione uma categoria</option>
            {% for categoria in categorias %}
            <option value="{{ categoria.id }}">{{ categoria.nome }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="mb-3">
          <label for="description" class="form-label">Descrição:</label>
          <textarea
            class="form-control"
            id="description"
            name="description"
            rows="3"
            required
          ></textarea>
        </div>
        <button type="submit" class="btn btn-primary" id="button">
          Cadastrar
        </button>
      </form>
    </div>
  </div>

  <hr />

  <h4 class="mt-5">Produtos Cadastrados</h4>
  <table class="table table-striped table-hover mt-3">
    <thead class="table-black">
      <tr>
        <th>ID</th>
        <th>Nome</th>
        <th>Ano</th>
        <th>Categoria</th>
        <th>Descrição</th>
        <th style="width: 150px">Ações</th>
      </tr>
    </thead>
    <tbody>
      {% for produto in products.items %}
      <tr>
        <td>{{ produto.id }}</td>
        <td>{{ produto.name }}</td>
        <td>{{ produto.year }}</td>
        <td>
          {{ produto.categoria.nome if produto.categoria else 'Sem categoria' }}
        </td>
        <td>{{ produto.description[:50] }}...</td>
        <td>
          <a
            href="{{ url_for('produto_editar', id=produto.id) }}"
            class="btn btn-sm" id="edit"
            >Editar</a
          >
          <a
            href="{{ url_for('produto_excluir', id=produto.id) }}"
            class="btn btn-sm" id="delete"
            onclick="return confirm('Tem certeza que deseja excluir este produto?')"
            >Excluir</a
          >
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <nav>
    <ul class="pagination justify-content-center">
      {% if products.has_prev %}
      <li class="page-item">
        <a
          class="page-link"
          href="{{ url_for('cadastro', page=products.prev_num) }}"
          >Anterior</a
        >
      </li>
      {% endif %} {% for page_num in products.iter_pages() %} {% if page_num %}
      <li class="page-item {% if products.page == page_num %}active{% endif %}">
        <a class="page-link" href="{{ url_for('cadastro', page=page_num) }}"
          >{{ page_num }}</a
        >
      </li>
      {% else %}
      <li class="page-item disabled"><span class="page-link">...</span></li>
      {% endif %} {% endfor %} {% if products.has_next %}
      <li class="page-item">
        <a
          class="page-link"
          href="{{ url_for('cadastro', page=products.next_num) }}"
          >Próxima</a
        >
      </li>
      {% endif %}
    </ul>
  </nav>
</div>
{% endblock content %}
